
<div class="container-fluid withnav">
    <div class="col-lg-12">

      <div class="summary-page">

      <nav>
        <uib-datepicker
          ng-model="selectedMonth"
          datepicker-options="{ minMode: 'month' }"
        >
        </uib-datepicker>
      </nav>

      <h2 class="nodata" ng-if="routes.length == 0">
          No seat data found for the selected month
      </h2>

        <div ng-if="routes.length > 0" class="route-summaries">
          <h2 ng-repeat-start="route in routes | orderBy:'label' track by $index">
            {{route.label}} ({{route.id}})
            :
            {{route.from}}
            {{route.trips[0].tripStops[0].time | date:'HH:mm'}}
            &mdash;
            {{route.to}}
            {{route.trips[0].tripStops[route.trips[0].tripStops.length-1].time | date:'HH:mm'}}
          </h3>
          <table
            ng-repeat-end
            ng-if="routes.length > 0">
            <tr>
              <td></td>
              <th ng-repeat="trip in route.priceSummary" colspan="{{trip.count}}" class="price-summary">
                <span ng-if="trip.price !== undefined">
                  ${{trip.price | number:2}} / {{trip.capacity}}<i class="glyphicon glyphicon-user"></i>
                </span>
              </th>
            </tr>
            <tr>
              <th>{{ route.trips[0].date | date:'MMM':'UTC'}}</th>
              <th ng-repeat='trip in route.tripsByDay track by $index'
                  ng-class="{ 'has-trip': route.tripsByDay[$index],
                          today: $index === today
                        }"
                  class="weekday day"
              >
              {{
                weekDays[$index] === 0 ? 'Su' :
                weekDays[$index] === 1 ? 'Mo' :
                weekDays[$index] === 2 ? 'Tu' :
                weekDays[$index] === 3 ? 'We' :
                weekDays[$index] === 4 ? 'Th' :
                weekDays[$index] === 5 ? 'Fr' :
                weekDays[$index] === 6 ? 'Sa' : ''
              }}
              </th>
            </tr>
            <tr>
              <th></th>
              <th ng-repeat='trip in route.tripsByDay track by $index'
                  ng-class="{ 'has-trip': route.tripsByDay[$index],
                          today: $index === today
                        }"
                  class="summary-day day"
              >
                {{$index + 1}}
              </th>
            </tr>
            <tr>
              <td></td>
              <td ng-repeat='trip in route.tripsByDay track by $index'
                  ng-class="{ 'has-trip': route.tripsByDay[$index],
                              today: $index === today,
                              cancelled: route.tripsByDay[$index].status === 'cancelled'
                            }"
                  class="passenger-count day"
              >
                <a href="#/bookings?tripId={{trip.id}}">
                {{trip ? trip.availability.seatsBooked || '0' : ''}}
                </a>
              </td>
            </tr>
          </table>
        </div>
      </div>

    </div></div>
